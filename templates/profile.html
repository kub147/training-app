<!DOCTYPE html>
<html>
<head>
    <title>{{ tx('Profil','Profile') }}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="/static/icons/icon-32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/icons/apple-touch-icon.png">
    <link rel="manifest" href="/static/manifest.webmanifest">
    <meta name="theme-color" content="#0f172a">
    <link rel="stylesheet" href="/static/css/main.css">
</head>
<body>
<div class="container">
    <header>
        <div class="header-row">
            <h1>üë§ {{ tx('Profil','Profile') }}</h1>
        </div>
        <div class="header-actions">
                            {% include "_theme_toggle.html" %}
            <a class="btn btn-outline" href="/">{{ t('nav_panel') }}</a>
            <a class="btn btn-outline" href="/logout">{{ t('nav_logout') }}</a>
        </div>
    </header>

    <p class="page-sub">{{ tx('Te dane sƒÖ u≈ºywane przez AI jako kontekst:','This data is used by AI as context:') }} <b>{{ tx('FAKTY','FACTS') }}</b> {{ tx('(sta≈Çe),','(stable),') }} <b>{{ tx('CELE','GOALS') }}</b> {{ tx('(cele) i','(goals) and') }} <b>{{ tx('STAN','STATE') }}</b> {{ tx('(czasowo wra≈ºliwe, np. uraz). Mo≈ºesz te≈º ponownie zaimportowaƒá ZIP ze Stravy.','(time-sensitive, e.g., injury). You can also re-import your Strava ZIP.') }}</p>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for m in messages %}
          <div class="flash info">{{ m }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <div class="card">
        <div class="section-title">üì¶ {{ tx('Ponowny import ZIP (opcjonalnie)','Re-import ZIP (optional)') }}</div>
        <p class="help-text">{{ tx('Strava: strava.com/account ‚Üí Pobierz lub usu≈Ñ konto ‚Üí Popro≈õ o archiwum.','Strava: strava.com/account -> Download or delete your account -> Request your archive.') }}</p>
        <form method="POST" action="/profile" enctype="multipart/form-data">
            <input type="hidden" name="action" value="reimport_zip">
            <div class="field">
                <label>{{ tx('Archiwum Strava (ZIP)','Strava archive (ZIP)') }}</label>
                <input type="file" name="strava_zip" accept=".zip" required>
            </div>
            <div class="actions">
                <button class="btn" type="submit">{{ tx('Zaimportuj ZIP','Import ZIP') }}</button>
            </div>
        </form>
    </div>

    <div class="card">
        <div class="section-title">üß† {{ tx('Dane do personalizacji','Personalization data') }}</div>
        <form method="POST" action="/profile">
            <input type="hidden" name="action" value="save">

            <div class="field">
                <label>{{ tx('FAKTY: Dyscypliny (w≈Çasnymi s≈Çowami)','FACTS: Disciplines (in your own words)') }}</label>
                <input type="text" name="primary_sports" placeholder="{{ tx('np. bieganie, rower, si≈Çownia','e.g. running, cycling, gym') }}" value="{{ profile.primary_sports or '' }}">
            </div>

            <div class="form-row">
                <div class="field">
                    <label>{{ tx('FAKTY: Ile masz czasu tygodniowo (h)?','FACTS: Weekly available time (h)?') }}</label>
                    <input type="text" inputmode="decimal" name="weekly_time_hours" value="{{ profile.weekly_time_hours if profile.weekly_time_hours is not none else '' }}" placeholder="{{ tx('np. 6 lub 6,5','e.g. 6 or 6.5') }}">
                </div>
                <div class="field">
                    <label>{{ tx('FAKTY: Ile km tygodniowo (opcjonalnie)?','FACTS: Weekly km (optional)?') }}</label>
                    <input type="text" inputmode="decimal" name="weekly_distance_km" value="{{ profile.weekly_distance_km if profile.weekly_distance_km is not none else '' }}" placeholder="{{ tx('np. 30,5 lub 30.5','e.g. 30.5 or 30,5') }}">
                </div>
            </div>

            <div class="form-row">
                <div class="field">
                    <label>{{ tx('FAKTY: Dni treningowe / tydzie≈Ñ','FACTS: Training days / week') }}</label>
                    <input type="number" min="0" name="days_per_week" value="{{ profile.days_per_week if profile.days_per_week is not none else '' }}" placeholder="{{ tx('np. 4','e.g. 4') }}">
                </div>
                <div class="field">
                    <label>{{ tx('FAKTY: Sesje biegowe / tydzie≈Ñ','FACTS: Run sessions / week') }}</label>
                    <input type="number" min="0" max="14" name="weekly_run_sessions" value="{{ profile.weekly_run_sessions if profile.weekly_run_sessions is not none else '' }}" placeholder="{{ tx('np. 3','e.g. 3') }}">
                </div>
            </div>

            <div class="form-row">
                <div class="field">
                    <label>{{ tx('FAKTY: Sesje si≈Çowe / tydzie≈Ñ','FACTS: Gym sessions / week') }}</label>
                    <input type="number" min="0" max="14" name="weekly_gym_sessions" value="{{ profile.weekly_gym_sessions if profile.weekly_gym_sessions is not none else '' }}" placeholder="{{ tx('np. 2','e.g. 2') }}">
                </div>
                <div class="field">
                    <label>{{ tx('FAKTY: Sesje p≈Çywackie / tydzie≈Ñ','FACTS: Swim sessions / week') }}</label>
                    <input type="number" min="0" max="14" name="weekly_swim_sessions" value="{{ profile.weekly_swim_sessions if profile.weekly_swim_sessions is not none else '' }}" placeholder="{{ tx('np. 1','e.g. 1') }}">
                </div>
            </div>

            <div class="form-row">
                <div class="field">
                    <label>{{ tx('FAKTY: Mobilno≈õƒá/core / tydzie≈Ñ','FACTS: Mobility/core sessions / week') }}</label>
                    <input type="number" min="0" max="14" name="weekly_mobility_sessions" value="{{ profile.weekly_mobility_sessions if profile.weekly_mobility_sessions is not none else '' }}" placeholder="{{ tx('np. 1','e.g. 1') }}">
                </div>
                <div class="field">
                    <label>{{ tx('FAKTY: Sesje rowerowe / tydzie≈Ñ','FACTS: Cycling sessions / week') }}</label>
                    <input type="number" min="0" max="14" name="weekly_ride_sessions" value="{{ profile.weekly_ride_sessions if profile.weekly_ride_sessions is not none else '' }}" placeholder="{{ tx('np. 1','e.g. 1') }}">
                </div>
            </div>

            <div class="field">
                <label>{{ tx('FAKTY: Do≈õwiadczenie','FACTS: Experience') }}</label>
                <input type="text" name="experience_text" value="{{ profile.experience_text or '' }}" placeholder="{{ tx('np. 2 lata biegania, 1 rok si≈Çowni','e.g. 2 years running, 1 year gym') }}">
            </div>

            <div class="form-row">
                <div class="field">
                    <label>{{ tx('Styl trenera','Coach style') }}</label>
                    <select name="coach_style">
                        <option value="" {% if not profile.coach_style %}selected{% endif %}>{{ tx('zbalansowany','balanced') }}</option>
                        <option value="concise" {% if profile.coach_style == 'concise' %}selected{% endif %}>{{ tx('kr√≥tko i konkretnie','concise') }}</option>
                        <option value="motivating" {% if profile.coach_style == 'motivating' %}selected{% endif %}>{{ tx('motywujƒÖco','motivating') }}</option>
                        <option value="technical" {% if profile.coach_style == 'technical' %}selected{% endif %}>{{ tx('technicznie','technical') }}</option>
                    </select>
                </div>
                <div class="field">
                    <label>{{ tx('Tolerancja ryzyka','Risk tolerance') }}</label>
                    <select name="risk_tolerance">
                        <option value="" {% if not profile.risk_tolerance %}selected{% endif %}>{{ tx('zbalansowana','balanced') }}</option>
                        <option value="conservative" {% if profile.risk_tolerance == 'conservative' %}selected{% endif %}>{{ tx('konserwatywna','conservative') }}</option>
                        <option value="balanced" {% if profile.risk_tolerance == 'balanced' %}selected{% endif %}>{{ tx('zbalansowana','balanced') }}</option>
                        <option value="aggressive" {% if profile.risk_tolerance == 'aggressive' %}selected{% endif %}>{{ tx('agresywna','aggressive') }}</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="field">
                    <label>{{ tx('Priorytet treningu','Training priority') }}</label>
                    <select name="training_priority">
                        <option value="" {% if not profile.training_priority %}selected{% endif %}>{{ tx('wynik + zdrowie','performance + health') }}</option>
                        <option value="performance" {% if profile.training_priority == 'performance' %}selected{% endif %}>{{ tx('wynik','performance') }}</option>
                        <option value="consistency" {% if profile.training_priority == 'consistency' %}selected{% endif %}>{{ tx('regularno≈õƒá','consistency') }}</option>
                        <option value="health" {% if profile.training_priority == 'health' %}selected{% endif %}>{{ tx('zdrowie','health') }}</option>
                    </select>
                </div>
                <div class="field">
                    <label>{{ tx('Docelowy czas (opcjonalnie)','Target time (optional)') }}</label>
                    <input type="text" name="target_time_text" value="{{ profile.target_time_text or '' }}" placeholder="{{ tx('np. P√≥≈Çmaraton 1:45:00','e.g. Half marathon 1:45:00') }}">
                </div>
            </div>

            <div class="field">
                <label>{{ tx('CELE: G≈Ç√≥wny cel','GOALS: Main goal') }}</label>
                <input type="text" name="goals_text" value="{{ profile.goals_text or '' }}" placeholder="{{ tx('np. 10 km w 45 min','e.g. 10 km in 45 min') }}">
            </div>
            <div class="field">
                <label>{{ tx('CELE: Wydarzenie docelowe (opcjonalnie)','GOALS: Target event (optional)') }}</label>
                <input type="text" name="target_event" value="{{ profile.target_event or '' }}" placeholder="{{ tx('np. P√≥≈Çmaraton Warszawski','e.g. City Half Marathon') }}">
            </div>
            <div class="field">
                <label>{{ tx('Preferencje','Preferences') }}</label>
                <textarea class="textarea-lg" name="preferences_text" placeholder="{{ tx('Co lubisz? Czego unikasz?','What do you like? What do you avoid?') }}">{{ profile.preferences_text or '' }}</textarea>
            </div>
            <div class="field">
                <label>{{ tx('Ograniczenia','Constraints') }}</label>
                <textarea class="textarea-lg" name="constraints_text" placeholder="{{ tx('Czas, sprzƒôt, dostƒôpno≈õƒá, kontuzje','Time, equipment, availability, injuries') }}">{{ profile.constraints_text or '' }}</textarea>
            </div>
            <div class="field">
                <label>{{ tx('STAN: Aktualny stan (zmƒôczenie/urazy)','STATE: Current status (fatigue/injuries)') }}</label>
                <textarea class="textarea-lg" name="injuries_text" placeholder="{{ tx('Np. b√≥l kolana od tygodnia','e.g. knee pain for a week') }}">{{ current_injury_text or '' }}</textarea>
            </div>

            <div class="actions">
                <button class="btn" type="submit">{{ tx('Zapisz zmiany','Save changes') }}</button>
            </div>
        </form>
    </div>
</div>
{% include "_chat_widget.html" %}
</body>
</html>
