<button class="btn btn-outline theme-toggle" type="button" id="themeToggle" aria-label="{{ tx('PrzeÅ‚Ä…cz tryb kolorÃ³w','Toggle color theme') }}">ğŸŒ™</button>
<script>
(function initThemeToggle() {
    if (window.__themeInit) return;
    window.__themeInit = true;

    const root = document.documentElement;
    const key = 'theme';
    const saved = localStorage.getItem(key);
    const startTheme = saved || 'light';
    root.setAttribute('data-theme', startTheme);

    const btn = document.getElementById('themeToggle');
    if (!btn) return;

    function syncIcon() {
        const t = root.getAttribute('data-theme') || 'light';
        btn.textContent = t === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        btn.title = t === 'dark' ? {{ tx('PrzeÅ‚Ä…cz na jasny','Switch to light')|tojson }} : {{ tx('PrzeÅ‚Ä…cz na ciemny','Switch to dark')|tojson }};
    }

    syncIcon();
    btn.addEventListener('click', function () {
        const current = root.getAttribute('data-theme') || 'light';
        const next = current === 'dark' ? 'light' : 'dark';
        root.setAttribute('data-theme', next);
        localStorage.setItem(key, next);
        syncIcon();
    });
})();
</script>
